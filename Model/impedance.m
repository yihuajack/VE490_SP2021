lambda_D = 4.56*10^(-9);
sigma = 0.018;
k = 6.12;
v_L0 = 2.82*10^(-9);
x_min = 1.6*10^(-6);
x_max = 12*10^(-6); % Psi_0 = 0.1;
l = 0.235;
c_0 = 299792458;
mu_0 = 4*pi*10^(-7);
epsilon_0 = 1/(mu_0*c_0^2);
epsilon = 80 * epsilon_0;
f = logspace(1,5);
omega = 2*pi*f;
A = ((2*lambda_D*sigma)^2+(omega*epsilon*pi*x_max).^2)./((2*lambda_D*sigma)^2+(omega*epsilon*pi*x_min).^2);
% A = sqrt(((2*lambda_D*sigma)^2+(omega*epsilon*pi).^2+x_min*x_max).^2+(2*lambda_D*sigma*omega*epsilon*pi*(x_max-x_min)).^2)./((2*lambda_D*sigma)^2+(omega*epsilon*pi*x_min).^2);
theta = atan((2*lambda_D*sigma*omega*epsilon*pi*(x_max-x_min))./((2*lambda_D*sigma)^2+(omega*epsilon*pi).^2*x_min*x_max));
Z = pi*(sqrt(k)+1/sqrt(k))./(l*sigma*(log(A)+2i*theta));
figure(1);
loglog(f/1000,abs(Z)); % ylim([100,10^5]);
xlabel('Frequency (kHz)'); ylabel('Impedance (\Omega)');
figure(2);
semilogx(f/1000,angle(Z));
xlabel('Frequency (kHz)'); ylabel('Phase (radians)');